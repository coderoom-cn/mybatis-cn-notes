
#解析器模块

##XML解析

在MyBatis中涉及多个XML配置文件，因此我们首先介绍XML解析的相关内容。
XML解析常见的方式有三种：
1. DOM（Document Object Model）解析方式
2. SAX（Simple API for XML）解析方式
3. JDK 6.0版本开始，JDK开始支持的StAX（Streaming API for XML）解析方式。

###DOM

DOM是基于树形结构的XML解析方式，它会将整个XML文档读入内存并构建一个DOM树，基于这棵树形结构对各个节点（Node）进行操作。XML 文档中的每个成分都是一个节点：整个文档是一个文档节点，每个XML标签对应一个元素节点，包含在XML标签中的文本是文本节点，每一个 XML 属性是一个属性节点，注释属于注释节点。

###SAX

SAX是基于事件模型的XML解析方式，它并不需要将整个XML文档加载到内存中，而只需将XML文档的一部分加载到内存中，即可开始解析，在处理过程中并不会在内存中记录XML中的数据，所以占用的资源比较小。当程序处理过程中满足条件时，也可以立即停止解析过程，这样就不必解析剩余的XML内容。
SAX的缺点也非常明显，因为不存储XML文档的结构，所以需要开发人员自己负责维护业务逻辑涉及的多层节点之间的关系，例如，某节点与其父节点之间的父子关系、与其子节点之间的父子关系。当XML文档非常复杂时，维护节点间关系的复杂度较高，工作量也就会比较大。另一方面，因为是流式处理，所以处理过程只能从XML文档开始向后单向进行，无法像DOM方式那样，自由导航到之前处理过的节点上重新处理，也无法支持XPath。SAX没有提供写XML文档的功能。

###StAX
JAXP是JDK提供的一套用于解析XML的 API，它很好地支持DOM和SAX解析方式，JAXP是JavaSE的一部分，它由javax.xml、org.w3c.dom、org.xml.sax 包及其子包组成。
开始，JAXP开始支持另一种XML解析方式，也就是下面要介绍的StAX解析方式。
StAX解析方式与SAX解析方式类似，它也是把XML文档作为一个事件流进行处理，但不同之处在于StAX采用的是“拉模式”。所谓“拉模式”是应用程序通过调用解析器推进解析的进程，如图2-4所示。在StAX解析方式中，应用程序控制着整个解析过程的推进，可以简化应用处理XML文档的代码，并且决定何时停止解析，而且StAX可以同时处理多个XML文档。

##XPath
MyBatis在初始化过程中处理mybatis-config.xml配置文件以及映射文件时，使用的是DOM解析方式，并结合使用XPath解析XML配置文件。
正如上述，DOM会将整个XML文档加载到内存中并形成树状数据结构，而XPath是一种为查询XML文档而设计的语言，它可以与DOM解析方式配合使用，实现对XML文档的解析。XPath之于XML就好比SQL语言之于数据库。